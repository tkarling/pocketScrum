{"version":3,"sources":["picsStore.js"],"names":[],"mappings":"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","file":"picsStore-compiled.js","sourcesContent":["\"use strict\";\n\nvar ADD_PIC = \"ADD_PIC\";\nvar REMOVE_PIC = \"REMOVE_PIC\";\nvar SELECT_PIC = \"SELECT_PIC\";\nvar SAVE_PIC = \"SAVE_PIC\";\n\nclass picsActions {\n    constructor(dispatcher) {\n        this.dispatcher = dispatcher;\n    }\n\n    addPic(item) {\n        this.dispatcher.emit({\n            actionType: ADD_PIC,\n            item: item\n        });\n    }\n\n    removePic(item) {\n        this.dispatcher.emit({\n            actionType: REMOVE_PIC,\n            item: item\n        });\n    }\n\n    selectPic(item) {\n        this.dispatcher.emit({\n            actionType: SELECT_PIC,\n            item: item\n        });\n    }\n\n    savePic(item) {\n        this.dispatcher.emit({\n            actionType: SAVE_PIC,\n            item: item\n        });\n    }\n}\nangular.module(\"myApp\").service(\"picsActions\", picsActions);\n\n\nclass PicsStore extends EventEmitter {\n    constructor(picsService) {\n        super();\n        this.picsService = picsService;\n\n        this.pics = [];\n        this.currentPic = {};\n        this.errorMsg = \"\";\n\n        this.emitSetChange();\n    }\n\n    getPics() {\n        return this.pics;\n    }\n\n    getCurrentPic() {\n        return this.currentPic;\n    }\n\n    getErrorMsg() {\n        return this.errorMsg;\n    }\n\n    addPic(pic) {\n        //this.pics.push({qty: 1, pic: pic});\n        var self = this;\n        this.errorMsg = \"\";\n        return this.picsService.addPic(pic)\n            .then(function (response) {\n                self.currentPic = response.data;\n            }, function (error) {\n                if (error.status > 0)\n                console.log(\"addPic error\", error);\n                self.errorMsg = error.status + ': ' + error.statusText;\n                self.currentPic = {};\n            }, function (evt) {\n                self.currentPic.progress = Math.min(100, parseInt(100.0 *\n                    evt.loaded / evt.total));\n                self.emitSetChange();\n            });\n    }\n\n    removePic(pic) {\n        if(this.currentPic.picId == pic.picId) {\n            this.currentPic = {};\n        }\n        return this.picsService.removePic(pic);\n    }\n\n    savePic(pic) {\n        return this.picsService.savePic(pic);\n    }\n\n    selectPic(pic) {\n        this.currentPic = pic;\n    }\n\n    emitSetChange() {\n        var self = this;\n        this.picsService.getPicDatas().then(function (picDatas) {\n            self.pics = picDatas;\n            self.emit(\"change\");\n        });\n    }\n\n    emitChange() {\n        this.emit(\"change\");\n    }\n\n\n}\n\nangular.module(\"myApp\").service(\"picsStore\", function (dispatcher, picsService) {\n    var picsStore = new PicsStore(picsService);\n\n    dispatcher.addListener(function (action) {\n        switch (action.actionType) {\n            case ADD_PIC:\n                picsStore.addPic(action.item).then(function (response) {\n                    picsStore.emitSetChange();\n                });\n                break;\n\n            case REMOVE_PIC:\n                picsStore.removePic(action.item).then(function (response) {\n                    picsStore.emitSetChange();\n                });\n                break;\n\n            case SAVE_PIC:\n                picsStore.savePic(action.item).then(function (response) {\n                    picsStore.emitSetChange();\n                });\n                break;\n\n            case SELECT_PIC:\n                picsStore.selectPic(action.item);\n                picsStore.emitChange();\n                break;\n        }\n\n\n    });\n\n    //expose only the public interface\n    this.addListener = function (l) {\n        picsStore.addListener(l);\n    };\n\n    this.getPics = function () {\n        return picsStore.getPics();\n    };\n\n    this.getCurrentPic = function () {\n        return picsStore.getCurrentPic();\n    };\n\n    this.getErrorMsg = function () {\n        return picsStore.getErrorMsg();\n    };\n});\n"]}