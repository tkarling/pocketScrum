{"version":3,"sources":["teamMemberStore.js"],"names":[],"mappings":"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","file":"teamMemberStore-compiled.js","sourcesContent":["\"use strict\";\n\nvar ADD_TEAM_MEMBER = \"ADD_TEAM_MEMBER\";\nvar REMOVE_TEAM_MEMBER = \"REMOVE_TEAM_MEMBER\";\nvar SAVE_TEAM_MEMBER = \"SAVE_TEAM_MEMBER\";\nvar SET_AUTH_USER = \"SET_AUTH_USER\";\nvar PROJECT_SET = \"PROJECT_SET\";\n\nclass teamMemberActions {\n    constructor(dispatcher) {\n        this.dispatcher = dispatcher;\n    }\n\n    addTeamMember(item) {\n        this.dispatcher.emit({\n            actionType: ADD_TEAM_MEMBER,\n            item: item\n        });\n    }\n\n    removeTeamMember(item) {\n        this.dispatcher.emit({\n            actionType: REMOVE_TEAM_MEMBER,\n            item: item\n        });\n    }\n\n    saveTeamMember(item) {\n        this.dispatcher.emit({\n            actionType: SAVE_TEAM_MEMBER,\n            item: item\n        });\n    }\n\n    setAuthUser(item) {\n        this.dispatcher.emit({\n            actionType: SET_AUTH_USER,\n            item: item\n        });\n    }\n\n    projectSet(item) {\n        this.dispatcher.emit({\n            actionType: PROJECT_SET,\n            item: item\n        });\n    }\n}\nangular.module(\"myApp\").service(\"teamMemberActions\", teamMemberActions);\n\n\nclass TeamMemberStore extends EventEmitter {\n    constructor(teamMemberService, C, $log) {\n        super();\n        this.$log = $log;\n        this.C = C;\n        this.teamMemberService = teamMemberService;\n\n        this.teamMembers = [];\n        this.authUserInfo = undefined;\n        this.errorMsg = \"\";\n\n        console.log(\"init TeamMemberStore\");\n\n    }\n\n    getTeamMembers() {\n        return this.teamMembers;\n    }\n\n    getErrorMsg() {\n        return this.errorMsg;\n    }\n\n    addTeamMember(teamMember) {\n        var self = this;\n        this.errorMsg = \"\";\n        return this.teamMemberService.addItem(teamMember)\n            .then(function (response) {\n            }, function (error) {\n                if (error.teamMember > 0) {\n                    this.$log.error(\"addTeamMember error\", error);\n                    self.errorMsg = error.teamMember + ': ' + error.teamMemberText;\n                }\n            });\n    }\n\n    removeTeamMember(teamMember) {\n        this.errorMsg = \"\";\n        return this.teamMemberService.removeItem(teamMember);\n    }\n\n    saveTeamMember(teamMember) {\n        this.errorMsg = \"\";\n        return this.teamMemberService.saveItem(teamMember);\n    }\n\n    setAuthUser(authInfo) {\n        return this.teamMemberService.getItem(\"authId\", authInfo.id).then((member) => {\n            if(member === null) {\n                var newMember = {\n                    authId: authInfo.id,\n                    authProvider: authInfo.provider,\n                    name: authInfo.displayName,\n                    currentProject : this.C.DEFAULT_PROJECT_ID\n                };\n                if(this.C.DEFAULT_MEMBER_PIC_ID) {\n                    newMember.picId = this.C.DEFAULT_MEMBER_PIC_ID;\n                }\n                return this.teamMemberService.addItem(newMember).then((addedMember) => {\n                    this.authUserInfo = addedMember;\n                }, (err) => {\n                    this.$log.error(\"error adding member\", err);\n                    this.authUserInfo = undefined;\n                    //deferred.reject(err);\n                });\n            } else {\n                this.authUserInfo = member;\n            }\n        }, (err) => {\n            this.$log.error(\"error getting auth user info\", err);\n            this.authUserInfo = undefined;\n        });\n    }\n\n    emitChange() {\n        var self = this;\n        this.teamMemberService.getItems().then(function (teamMembers) {\n            self.teamMembers = teamMembers;\n            self.emit(\"change\");\n        });\n    }\n\n}\n\nangular.module(\"myApp\").service(\"teamMemberStore\", function ($log, C, dispatcher, teamMemberService) {\n    var teamMemberStore = new TeamMemberStore(teamMemberService, C, $log);\n\n    dispatcher.addListener(function (action) {\n        switch (action.actionType) {\n            case ADD_TEAM_MEMBER:\n                teamMemberStore.addTeamMember(action.item).then(function (response) {\n                    teamMemberStore.emitChange();\n                });\n                break;\n\n            case REMOVE_TEAM_MEMBER:\n                teamMemberStore.removeTeamMember(action.item).then(function (response) {\n                    teamMemberStore.emitChange();\n                });\n                break;\n\n            case SAVE_TEAM_MEMBER:\n                teamMemberStore.saveTeamMember(action.item).then(function (response) {\n                    teamMemberStore.emitChange();\n                });\n                break;\n\n            case SET_AUTH_USER:\n                //teamMemberStore.setAuthUser(action.item);\n                teamMemberStore.setAuthUser(action.item).then(function (response) {\n                    teamMemberStore.emitChange();\n                });\n                break;\n\n            case PROJECT_SET:\n                teamMemberStore.emitChange();\n                break;\n        }\n\n\n    });\n\n    //expose only the public interface\n    this.addListener = function (l) {\n        teamMemberStore.addListener(l);\n    };\n\n    this.getTeamMembers = function () {\n        return teamMemberStore.getTeamMembers();\n    };\n\n    this.getErrorMsg = function () {\n        return teamMemberStore.getErrorMsg();\n    };\n\n    this.getAuthUserInfo = function() {\n        return teamMemberStore.authUserInfo;\n    }\n});\n\n\n"]}